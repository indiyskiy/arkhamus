<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html" lang="en">
<head>
    <title>Level</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>

<div class="header">
    <footer>
        <a th:href="@{/public/browser/menu}" title="Menu">Menu</a>
        <a th:href="@{/admin/browser/levels}" title="Levels">Levels</a>
        <a th:href="@{/admin/browser/level/{levelId}(levelId=${levelId})}" title="Level">Level</a>
        <a th:href="@{/admin/browser/level/{levelId}/quests(levelId=${levelId})}" title="Quests">Quests</a>
    </footer>
</div>

<div class="main">
    <form
            th:action="@{/admin/browser/level/{levelId}/quest/{questId}(levelId=${quest.levelId}, questId=${quest.id})}"
            method="post"
            th:object="${quest}"
    >

        <!-- Field for 'id' in AdminQuestDto -->
        <div>
            <label for="id" hidden="hidden"></label><input type="text" th:field="${quest.id}" id="id" hidden="hidden"/>
        </div>
        <!-- Field for 'name' in AdminQuestDto -->
        <div>
            <label for="name">Name:</label>
            <input type="text" th:field="${quest.name}" id="name"/>
        </div>

        <!-- Field for 'state' in AdminQuestDto -->
        <div>
            <label for="state">State:</label>
            <input type="text" th:field="${quest.state}" id="state"/>
        </div>
        <!-- QuestStepDto fields for all steps -->
        <div class="step-item" th:each="step, iterStatus : *{steps}">
            <div class="step-content">
                <div class="form-group">
                    <label th:for="${step.number}">Number</label>
                    <label>
                        <input type="text"
                               th:field="*{steps[__${iterStatus.index}__].number}"
                               th:id="${step.number}">
                    </label>
                    <label hidden="hidden">
                        <input type="text"
                               th:field="*{steps[__${iterStatus.index}__].id}"
                               th:id="${step.id}"
                               hidden="hidden"
                        >
                    </label>
                </div>
                <div class="form-group">
                    <label th:for="${step.levelTask.id}">Level Task Id</label>
                    <label>
                        <select th:field="*{steps[__${iterStatus.index}__].levelTask.id}"
                                th:id="${step.levelTask.id}">
                            <option th:each="task : ${possibleTasks}"
                                    th:value="${task.id}"
                                    th:text="${task.name}">
                            </option>
                        </select>
                    </label>
                </div>
            </div>
        </div>

        <!-- Save Button -->
        <div>
            <input type="submit" value="Save">
        </div>

    </form>
</div>
<!-- Add Button -->
<form method="post"
      th:action="@{/admin/browser/level/{levelId}/quest/{questId}/addStep(levelId=${levelId}, questId=${quest.id})}"
      th:object="${quest}">
    <input type="submit" value="add step">
</form>

<div class="footer">
    <footer>
        <a th:href="@{/public/browser/menu}" title="Menu">Menu</a>
        <a th:href="@{/admin/browser/levels}" title="Levels">Levels</a>
        <a th:href="@{/admin/browser/level/{levelId}(levelId=${levelId})}" title="Level">Level</a>
        <a th:href="@{/admin/browser/level/{levelId}/quests(levelId=${levelId})}" title="Quests">Quests</a>
    </footer>

</div>
</body>
</html>